# 麻雀に関するツール群（ご注文は麻雀ですか？）

## はじめに

私は麻雀というゲームが好きで、やっているうちにふと麻雀とプログラミングとの間に関連性を見出すようになりそこからこのようなツール群を開発してみようという流れになりました。

## 麻雀について

### 概要

中国から伝来した室内遊戯の一つであり、基本的に4人で牌（パイ）というものを用いて遊ぶゲームです。とても簡潔に言うと「絵合わせゲーム」とも解釈できるかもしれません。
トランプのポーカーを思い浮かべていただくとイメージが沸くかもしれませんが、このゲームに関しても何かしらの役を作るという事が目標になります。
最初にアガリ（役を完成させた人）が役に応じた点数（厳密に言うと役以外も点数に影響する場合があるがここでは省略）をもらえ、ゲーム終了時に点数が多い人の順から一位（トップ）、低い人が四位（ラス）といった具合のルールになっております。

### あがるには（手牌について）

麻雀は14枚の牌を揃えて完成系（アガリ）を作るというゲームです。
まず、麻雀にはアガリの型について以下のような決まりがあります。
（例外を除く基本的な型）

**3枚 × 4 + 同じ牌2枚**

以下の画像が完成系の型の例になります。
![tepai14sample](./images/readme/tepai14sample.png)

そして、この3枚という部分の作り方は以下の2通りが存在します。

**順子（シュンツ）**

以下が一例です

<img src="./images/readme/shuntsu_manzu.png" width="20%"> 　　<img src="./images/readme/shuntsu_pinzu.png" width="20%">　　<img src="./images/readme/shuntsu_souzu.png" width="20%">

（注意）123や234といった並びのものは認められますが、891のようなものは認められません。

**刻子（コーツ）**

以下が一例です

<img src="./images/readme/kotsu_manzu.png" width="20%"> 　　<img src="./images/readme/kotsu_pinzu.png" width="20%">　　<img src="./images/readme/kotsu_jipai.png" width="20%">

字牌で順子を作ることはできないので例外を除き刻子を作る目的として利用されることになります。

そして、残りの同じ牌2枚に関しては **雀頭（じゃんとう）** と呼びます。
しばしば、頭（アタマ）や枕（まくら）とも呼ばれることがあります。

### 役の完成

そして、現代の日本の麻雀ではあがるためには完成した手牌に何かしらの **役（やく）** というものが含まれていなければならないという決まりがあります。
国士無双（こくしむそう）、断么九（タンヤオ）　辺りは聞いたことがある方もおられるのではないでしょうか。そのようなものが役というものになります。

役については種類が多く説明が難しいので以下のサイトなどを参考にしていただけると良いかと思います。

**麻雀の役 一覧表 シンプル見やすい！ | 麻雀豆腐**

<https://majandofu.com/mahjong-hands-simple>

その他色々なルールがあり難しいな複雑だなと感じる部分がおありかとは思いますが、そのような要素があってこそプログラミングに組み込むやりがいというものがあったりする物だったりするので私は個人的には面白いんじゃないかいいじゃないかと捉えております！

# ツールについて

現時点ではこのソースコード内に以下のツールが存在しております。

## 点数計算ツール

任意の手牌をユーザが入力して、そこから役の判定や点数計算を行えるといったものになっております。
「mahjong_keisan/keisan.html」を開くことで起動します。

開くと以下のような画面が現れます。
（現段階にて実装されているものについて番号を振っております）

<img src="./images/readme/mahjong_keisan_view.png">

### 1：手牌

現在の手牌が表示されます。初期状態は全て灰色で何も入力されていません。
後述する１１のボタンを用いて任意の手牌を入力することができます。
手牌入力時は、マンズ、ピンズ、ソーズ、字牌の順に理牌（リーパイ、牌がソートされること）が自動で行われるようになっております。
また、任意の入力された手牌をクリックすることでその位置の手牌を削除することができます。
このときにも削除された牌を詰める形で理牌が行われます。

### 2：場風

麻雀には場風という概念が存在します。親が一周することで場というものが東、南、西、北の順で変化するのですが（東一局などという言葉を耳にされている方もいるかもしれませんがこれのことです）それを設定できるような機能になっております。これにより計算ツール上では、風牌を刻子としてそろえた際に役として認められるか否かなどが決まるようになっています。

### 3：自風

場風とは少し別の概念として自風というものが存在します。麻雀には親、子という概念があるのですが、ゲームの最初に親を決めてその人の場風が「東」になるという決まりがあります。
これはゲーム終了後の結果により反時計回りのような形で変化するようになっておりますが、計算ツール上では東の場合は親、それ以外の場合は子という風に扱うようにしております。この自風についても風牌の刻子が役として認められるか否かが影響します。そして、親と子の違いでアガリの時の点数も変化するのでこれの違いにより点数計算の結果も変わるようになっています。

### 4：立直

現代の日本麻雀においてかなり出現度が高いといっても過言でない役、立直（リーチ）です。
このボタンではそれを選択することができます。
画像では黒い文字ですが一度押すことで赤い文字に変化するのでその状態が立直している状態という風に扱われます。
さらにその状態からもう一度クリックするとダブル立直（鳴きのない一巡目で立直するという珍しい役）を設定することもできます。
そしてこのダブル立直の状態から再度クリックすることで立直の状態を解除できます。
以下の図ようなトグル式のボタンになっております。

<img src="./images/readme/reach_button_flow.png">

### 5：全消去

画面上で行った全ての操作（後述する詳細設定も含む）を消去して初期状態にリセットします。
現段階では保存機能などがありませんので使用時は注意してください。

### 6：詳細設定

このボタンを押下すると以下のようなダイアログが出現します。



## 待ち当てツール

手牌が自動生成される仕組みになっており（おもに清一色という役に該当するものが生成される）それの待ちをユーザが考えて当てる練習ができるものとなっております。
「mahjong_machiate/machiate.html」を開くことで起動します。

## 手牌生成ツール

こちらは現在開発中のものになります。指定した役から特定の手牌を生成するといったことができるようにしたいなと考えております。
「mahjong_tehaimaker/tehaimaker.html」を開くことで起動します。